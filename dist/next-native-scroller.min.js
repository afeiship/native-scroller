!function(){var t,e,o,s=s||this,i=s.nx||require("next-js-core2"),n=i.dom.Event||require("next-dom-event"),c=function(){return c||s.webkitRequestAnimationFrame||s.mozRequestAnimationFrame||function(t){s.setTimeout(t,1e3/60)}}();s.navigator.pointerEnabled?(t="pointerdown",e="pointermove",o="pointerup"):s.navigator.msPointerEnabled?(t="MSPointerDown",e="MSPointerMove",o="MSPointerUp"):"ontouchstart"in window?(t="touchstart",e="touchmove",o="touchend"):(t="mousedown",e="mousemove",o="mouseup");var r,l,a,h={easeOutCubic:function(t){return--t*t*t+1}},u=!1,d=!1,v=0,f=0,m=!1,p=null,T=null,L=!0,S=i.declare("nx.NativeScroller",{methods:{init:function(s,c,h){var u=["handleTouchstart","handleTouchmove","handleTouchend","handleScroll","activate","deactivate","tail"];window.ss=this,r=s,l=c,a=h,i.bindAll(u,this),this._touchStartRes=n.on(l,t,this.handleTouchstart),this._touchMoveRes=n.on(document,e,this.handleTouchmove),this._touchEndRes=n.on(document,o,this.handleTouchend),this._scrollRes=n.on(r,"scroll",this.handleScroll),this.overscroll(0)},destroy:function(){l&&(this._touchStartRes.destroy(),this._touchMoveRes.destroy(),this._touchEndRes.destroy()),r&&this._scrollRes.destroy(),r=null,l=null},finish:function(){var t=this;setTimeout(function(){c(t.tail),t.scrollTo(0,500,t.deactivate),setTimeout(function(){d&&(d=!1,t.setScrollLock(!1))},500)},500)},handleTouchstart:function(t){t.touches=t.touches||[{screenX:t.screenX,screenY:t.screenY}],p=Math.floor(t.touches[0].screenY)},handleTouchend:function(t){p=null,(L||u)&&(u?(u=!1,v=0,f>30?(this.start(),this.scrollTo(30,500)):(this.scrollTo(0,500,this.deactivate),d=!1)):(v=0,d=!1,this.setScrollLock(!1)))},handleTouchmove:function(t){if(t.touches=t.touches||[{screenX:t.screenX,screenY:t.screenY}],p||"mousemove"!=t.type){if(null===p&&(p=t.touches[0].screenY),(T=t.touches[0].screenY-p)-v<=0||r.scrollTop>0)return d&&(d=!1,this.setScrollLock(!1)),u&&this.nativescroll(r,T- -1*v),void(0!==f&&this.overscroll(0));T>0&&0===r.scrollTop&&!d&&(v=T),t.preventDefault(),d||(d=!0,this.setScrollLock(!0)),u=!0,this.overscroll((T-v)/3),!m&&f>30?(m=!0,c(this.activate)):m&&f<30&&(m=!1,c(this.deactivate))}},handleScroll:function(t){L=0===t.target.scrollTop||u},overscroll:function(t){l.style["-webkit-transform"]="translate3d(0px, "+t+"px, 0px)",a.style["-webkit-transform"]="translate3d(0px, "+(l.getBoundingClientRect().top-40)+"px, 0px)",f=t,this.fire("move")},nativescroll:function(t,e){t.scrollTop=e;var o=document.createEvent("UIEvents");o.initUIEvent("scroll",!0,!0,s,1),t.dispatchEvent(o)},setScrollLock:function(t){var e=this;c(t?function(){l.classList.add("overscroll"),e.show()}:function(){l.classList.remove("overscroll"),e.hide(),e.deactivate()})},scrollTo:function(t,e,o){function s(){var l=Date.now(),a=Math.min(1,(l-n)/e),u=h.easeOutCubic(a);i.overscroll(Math.floor(u*(t-r)+r)),a<1?c(s):(t<5&&t>-5&&(d=!1,i.setScrollLock(!1)),o&&o())}var i=this,n=Date.now(),r=f;if(r===t)return void o();c(s)},show:function(){this.fire("init"),a.classList.remove("invisible")},hide:function(){a.classList.add("invisible")},activate:function(){a.classList.add("active"),this.fire("active")},deactivate:function(){var t=this;setTimeout(function(){a.classList.remove("active"),a.classList.remove("refreshing"),a.classList.remove("refreshing-tail"),m&&(m=!1,t.fire("finish"))},150)},tail:function(){a.classList.add("refreshing-tail"),this.fire("loaded")},start:function(){this.fire("load"),a.classList.add("refreshing"),this.finish()}}});"undefined"!=typeof module&&module.exports&&(module.exports=S)}();