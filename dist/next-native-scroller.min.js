!function(){var e,t,o,s=s||this,i=s.nx||require("next-js-core2"),n=i.dom.Event||require("next-dom-event"),r=function(){return r||s.webkitRequestAnimationFrame||s.mozRequestAnimationFrame||function(e){s.setTimeout(e,1e3/60)}}();s.navigator.pointerEnabled?(e="pointerdown",t="pointermove",o="pointerup"):s.navigator.msPointerEnabled?(e="MSPointerDown",t="MSPointerMove",o="MSPointerUp"):"ontouchstart"in window?(e="touchstart",t="touchmove",o="touchend"):(e="mousedown",t="mousemove",o="mouseup");var c,l,h,a={easeOutCubic:function(e){return--e*e*e+1}},u=!1,d=!1,v=0,f=0,m=!1,T=null,p=null,L=!0,S=i.declare("nx.NativeScroller",{methods:{init:function(s,r,a){var u=["handleTouchstart","handleTouchmove","handleTouchend","handleScroll"];window.ss=this,c=s,l=r,h=a,i.bindAll(u,this),this._touchStartRes=n.on(l,e,this.handleTouchstart),this._touchMoveRes=n.on(l,t,this.handleTouchmove),this._touchEndRes=n.on(l,o,this.handleTouchend),this._scrollRes=n.on(c,"scroll",this.handleScroll),this._refresherHeight=h.offsetHeight,this.overscroll(0)},destroy:function(){l&&(this._touchStartRes.destroy(),this._touchMoveRes.destroy(),this._touchEndRes.destroy()),c&&this._scrollRes.destroy(),c=null,l=null},finish:function(){var e=this;setTimeout(function(){r(e.tail.bind(e)),e.scrollTo(0,500,e.deactivate.bind(e)),setTimeout(function(){d&&(d=!1,e.setScrollLock(!1))},500)},500)},handleTouchstart:function(e){e.touches=e.touches||[{screenX:e.screenX,screenY:e.screenY}],T=Math.floor(e.touches[0].screenY)},handleTouchend:function(e){T=null,(L||u)&&(u?(u=!1,v=0,f>60?(this.start(),this.scrollTo(60,500)):(this.scrollTo(0,500,this.deactivate.bind(this)),d=!1)):(v=0,d=!1,this.setScrollLock(!1)))},handleTouchmove:function(e){if(e.touches=e.touches||[{screenX:e.screenX,screenY:e.screenY}],T||"mousemove"!=e.type){if(null===T&&(T=e.touches[0].screenY),(p=e.touches[0].screenY-T)-v<=0||c.scrollTop>0)return d&&(d=!1,this.setScrollLock(!1)),u&&this.nativescroll(c,p- -1*v),void(0!==f&&this.overscroll(0));p>0&&0===c.scrollTop&&!d&&(v=p),e.preventDefault(),d||(d=!0,this.setScrollLock(!0)),u=!0,this.overscroll((p-v)/3),!m&&f>60?(m=!0,r(this.activate.bind(this))):m&&f<60&&(m=!1,r(this.deactivate.bind(this)))}},handleScroll:function(e){L=0===e.target.scrollTop||u},overscroll:function(e){l.style["-webkit-transform"]="translate3d(0px, "+(e-this._refresherHeight)+"px, 0px)",f=e,this.fire("move")},nativescroll:function(e,t){e.scrollTop=t;var o=document.createEvent("UIEvents");o.initUIEvent("scroll",!0,!0,s,1),e.dispatchEvent(o)},setScrollLock:function(e){var t=this;r(e?function(){l.classList.add("overscroll"),t.show()}:function(){l.classList.remove("overscroll"),t.hide(),t.deactivate()})},scrollTo:function(e,t,o){function s(){var l=Date.now(),h=Math.min(1,(l-n)/t),u=a.easeOutCubic(h);i.overscroll(Math.floor(u*(e-c)+c)),h<1?r(s):(e<5&&e>-5&&(d=!1,i.setScrollLock(!1)),o&&o())}var i=this,n=Date.now(),c=f;if(c===e)return void o();r(s)},show:function(){this.fire("init"),h.classList.remove("invisible")},hide:function(){h.classList.add("invisible")},activate:function(){h.classList.add("active"),this.fire("active")},deactivate:function(){var e=this;setTimeout(function(){h.classList.remove("active"),h.classList.remove("refreshing"),h.classList.remove("refreshing-tail"),m&&(m=!1,e.fire("finish"))},150)},tail:function(){h.classList.add("refreshing-tail"),this.fire("loaded")},start:function(){this.fire("load"),h.classList.add("refreshing"),this.finish()}}});"undefined"!=typeof module&&module.exports&&(module.exports=S)}();