!function(){var t,e,o,n=n||this,s=n.nx||require("next-js-core2"),i=s.dom.Event||require("next-dom-event"),r=s.throttle||require("next-debounce-throttle"),c=s.TouchEvents||require("next-touch-events"),l=n.requestAnimationFrame||require("raf-polyfill"),h=navigator.userAgent.match(/Android\s([0-9\.]*)/i),u={easeOutCubic:function(t){return--t*t*t+1}},a=!1,d=!1,f=0,v=0,T=!1,m=null,p=null,S=!0,R=s.declare("nx.NativeScroller",{properties:{containerBound:{get:function(){return t.getBoundingClientRect()}},scrollerBound:{get:function(){return e.getBoundingClientRect()}}},methods:{init:function(n,r,l){var h=["handleTouchstart","handleTouchmove","handleTouchend","handleScroll","activate","deactivate","show","tail"];window.ss=this,t=n,e=r,o=l,s.bindAll(h,this),this._touchStartRes=i.on(e,c.TOUCH_START,this.handleTouchstart),this._touchMoveRes=i.on(e,c.TOUCH_MOVE,this.handleTouchmove),this._touchEndRes=i.on(e,c.TOUCH_END,this.handleTouchend),this._scrollRes=i.on(t,"scroll",this.handleScroll),this.overscroll(0)},destroy:function(){e&&(this._touchStartRes.destroy(),this._touchMoveRes.destroy(),this._touchEndRes.destroy()),t&&this._scrollRes.destroy(),t=null,e=null},activatePullToRrefresh:function(){this.overscroll(50),this.start()},finish:function(){var t=this;setTimeout(function(){l(t.tail),t.scrollTo(0,500,t.deactivate),setTimeout(function(){d&&(d=!1,t.setScrollLock(!1))},500)},500)},handleTouchstart:function(t){t.touches=t.touches||[{screenX:t.screenX,screenY:t.screenY}],m=Math.floor(t.touches[0].screenY)},handleTouchend:function(t){m=null,(S||a)&&(a?(a=!1,f=0,v>50?(this.start(),this.scrollTo(50,500)):(this.scrollTo(0,500,this.deactivate),d=!1)):(f=0,d=!1,this.setScrollLock(!1)))},handleTouchmove:function(e){if(e.touches=e.touches||[{screenX:e.screenX,screenY:e.screenY}],m||"mousemove"!=e.type){if(null===m&&(m=e.touches[0].screenY),p=e.touches[0].screenY-m,h&&h.length&&p>0&&t.scrollTop,p-f<=0||t.scrollTop>0)return d&&(d=!1,this.setScrollLock(!1)),a&&this.nativescroll(t,p- -1*f),void(0!==v&&this.overscroll(0));p>0&&0===t.scrollTop&&!d&&(f=p),e.preventDefault(),d||(d=!0,this.setScrollLock(!0)),a=!0,this.overscroll((p-f)/3),!T&&v>50?(T=!0,l(this.activate)):T&&v<50&&(T=!1,l(this.deactivate))}},checkBounds:function(){var t=this;r(function(){t.scrollerBound.bottom-t.containerBound.bottom<50&&t.fire("infiniter:load")},100)},handleScroll:function(t){S=0===t.target.scrollTop||a,this.fire("scroll"),this.checkBounds()},overscroll:function(t){e.style["-webkit-transform"]="translate3d(0, "+t+"px, 0)",o.style["-webkit-transform"]="translate3d(0, "+(this.scrollerBound.top-40)+"px, 0)",v=t,this.fire("move")},nativescroll:function(t,e){t.scrollTop=e;var o=document.createEvent("UIEvents");o.initUIEvent("scroll",!0,!0,n,1),t.dispatchEvent(o)},setScrollLock:function(t){l(t?this.show:this.deactivate)},scrollTo:function(t,e,o){function n(){var c=Date.now(),h=Math.min(1,(c-i)/e),a=u.easeOutCubic(h);s.overscroll(Math.floor(a*(t-r)+r)),h<1?l(n):(t<5&&t>-5&&(d=!1,s.setScrollLock(!1)),o&&o())}var s=this,i=Date.now(),r=v;if(r===t)return void o();l(n)},show:function(){this.fire("init")},activate:function(){this.fire("active")},deactivate:function(){var t=this;setTimeout(function(){T&&(T=!1,t.fire("finish"))},150)},tail:function(){this.fire("loaded")},start:function(){this.fire("load"),this.finish()}}});"undefined"!=typeof module&&module.exports&&(module.exports=R)}();