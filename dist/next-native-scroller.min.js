!function(){var t,e,o,n=n||this,s=n.nx||require("next-js-core2"),i=s.dom.Event||require("next-dom-event"),r=s.throttle||require("next-debounce-throttle"),c=s.TouchEvents||require("next-touch-events"),l=n.requestAnimationFrame||require("raf-polyfill"),h={easeOutCubic:function(t){return--t*t*t+1}},u=!1,a=!1,d=0,f=0,v=!1,T=null,m=null,p=!0,S=s.declare("nx.NativeScroller",{properties:{containerBound:{get:function(){return t.getBoundingClientRect()}},scrollerBound:{get:function(){return e.getBoundingClientRect()}}},methods:{init:function(n,r,l){var h=["handleTouchstart","handleTouchmove","handleTouchend","handleScroll","activate","deactivate","show","tail"];window.ss=this,t=n,e=r,o=l,s.bindAll(h,this),this._touchStartRes=i.on(e,c.TOUCH_START,this.handleTouchstart),this._touchMoveRes=i.on(e,c.TOUCH_MOVE,this.handleTouchmove),this._touchEndRes=i.on(e,c.TOUCH_END,this.handleTouchend),this._scrollRes=i.on(t,"scroll",this.handleScroll),this.overscroll(0)},destroy:function(){e&&(this._touchStartRes.destroy(),this._touchMoveRes.destroy(),this._touchEndRes.destroy()),t&&this._scrollRes.destroy(),t=null,e=null},activatePullToRrefresh:function(){this.overscroll(50),this.start()},finish:function(){var t=this;setTimeout(function(){l(t.tail),t.scrollTo(0,500,t.deactivate),setTimeout(function(){a&&(a=!1,t.setScrollLock(!1))},500)},500)},handleTouchstart:function(t){t.touches=t.touches||[{screenX:t.screenX,screenY:t.screenY}],T=Math.floor(t.touches[0].screenY)},handleTouchend:function(t){T=null,(p||u)&&(u?(u=!1,d=0,f>50?(this.start(),this.scrollTo(50,500)):(this.scrollTo(0,500,this.deactivate),a=!1)):(d=0,a=!1,this.setScrollLock(!1)))},handleTouchmove:function(e){if(e.touches=e.touches||[{screenX:e.screenX,screenY:e.screenY}],T||"mousemove"!=e.type){if(null===T&&(T=e.touches[0].screenY),(m=e.touches[0].screenY-T)-d<=0||t.scrollTop>0)return a&&(a=!1,this.setScrollLock(!1)),u&&this.nativescroll(t,m- -1*d),void(0!==f&&this.overscroll(0));m>0&&0===t.scrollTop&&!a&&(d=m),e.preventDefault(),a||(a=!0,this.setScrollLock(!0)),u=!0,this.overscroll((m-d)/3),!v&&f>50?(v=!0,l(this.activate)):v&&f<50&&(v=!1,l(this.deactivate))}},checkBounds:function(){var t=this;r(function(){t.scrollerBound.bottom-t.containerBound.bottom<50&&t.fire("infiniter:load")},100)},handleScroll:function(t){p=0===t.target.scrollTop||u,this.fire("scroll"),this.checkBounds()},overscroll:function(t){e.style["-webkit-transform"]="translate3d(0, "+t+"px, 0)",o.style["-webkit-transform"]="translate3d(0, "+(this.scrollerBound.top-40)+"px, 0)",f=t,this.fire("move")},nativescroll:function(t,e){t.scrollTop=e;var o=document.createEvent("UIEvents");o.initUIEvent("scroll",!0,!0,n,1),t.dispatchEvent(o)},setScrollLock:function(t){l(t?this.show:this.deactivate)},scrollTo:function(t,e,o){function n(){var c=Date.now(),u=Math.min(1,(c-i)/e),d=h.easeOutCubic(u);s.overscroll(Math.floor(d*(t-r)+r)),u<1?l(n):(t<5&&t>-5&&(a=!1,s.setScrollLock(!1)),o&&o())}var s=this,i=Date.now(),r=f;if(r===t)return void o();l(n)},show:function(){this.fire("init")},activate:function(){this.fire("active")},deactivate:function(){var t=this;setTimeout(function(){v&&(v=!1,t.fire("finish"))},150)},tail:function(){this.fire("loaded")},start:function(){this.fire("load"),this.finish()}}});"undefined"!=typeof module&&module.exports&&(module.exports=S)}();